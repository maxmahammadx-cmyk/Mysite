<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>لعبة تسريع الكتابة</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #111;
  color: #fff;
  text-align: center;
}
#controls {
  padding: 10px;
  background: #222;
}
select, button, input {
  padding: 8px;
  margin: 5px;
  font-size: 16px;
}
#gameArea {
  position: relative;
  width: 100%;
  height: 60vh; /* مساحة اللعب ثابتة فوق الكيبورد */
  background: #003366; /* خلفية داكنة */
  overflow: hidden;
}
.word {
  position: absolute;
  top: 0;
  font-size: 28px;
  color: #fff;
  font-weight: bold;
  text-shadow: 1px 1px 3px #000;
}
.explosion {
  position: absolute;
  width: 40px;
  height: 40px;
  background: orange;
  border-radius: 50%;
  animation: boom 0.3s ease-out forwards;
}
@keyframes boom {
  0% { transform: scale(0.5); opacity: 1;}
  100% { transform: scale(2); opacity: 0;}
}
#player {
  position: absolute;
  bottom: 10px;
  left: 50%;
  width: 60px;
  height: 60px;
  background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Paper_plane_icon.svg/64px-Paper_plane_icon.svg.png') no-repeat center/contain;
  transform: translateX(-50%);
}
#typingInput {
  width: 90%;
  font-size: 20px;
  margin-top: 10px;
  text-align: center;
}
#scoreBoard {
  margin-top: 5px;
}
#gameOver {
  display: none;
  background: rgba(0,0,0,0.8);
  color: #fff;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 60vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-size: 24px;
}
</style>
</head>
<body>

<div id="controls">
  <label>اللغة:</label>
  <select id="lang">
    <option value="ar">عربية</option>
    <option value="en">English</option>
  </select>
  <label>الصعوبة:</label>
  <select id="difficulty">
    <option value="easy">سهل</option>
    <option value="medium">متوسط</option>
    <option value="hard">صعب</option>
  </select>
  <button onclick="startGame()">ابدأ اللعبة</button>
  <div id="scoreBoard">النتيجة: <span id="score">0</span> | أخطاء: <span id="missed">0</span>/3</div>
</div>

<div id="gameArea">
  <div id="player"></div>
  <div id="gameOver">
    <div>انتهت اللعبة</div>
    <div>نتيجتك: <span id="finalScore"></span></div>
    <button onclick="startGame()">إعادة المحاولة</button>
  </div>
</div>

<input id="typingInput" placeholder="اكتب هنا الكلمة..." disabled>

<script>
// كلمات عربية وإنجليزية
const wordsAr = ['كتاب','قمر','شمس','بحر','سماء','ورد','بيت','مدرسة','سيارة','قلم','هاتف','قط','سعيد','صبر','أمل'];
const wordsEn = ['book','moon','sun','sea','sky','flower','house','school','car','pen','phone','cat','happy','patience','hope'];

let gameInterval, spawnInterval;
let words = [];
let score = 0;
let missed = 0;
let speed = 1;
let spawnRate = 2000;

const gameArea = document.getElementById('gameArea');
const typingInput = document.getElementById('typingInput');
const scoreSpan = document.getElementById('score');
const missedSpan = document.getElementById('missed');
const gameOverDiv = document.getElementById('gameOver');
const finalScoreSpan = document.getElementById('finalScore');

function startGame() {
  // إعدادات
  const lang = document.getElementById('lang').value;
  const diff = document.getElementById('difficulty').value;
  if (diff === 'easy'){ speed = 1; spawnRate = 2000;}
  if (diff === 'medium'){ speed = 2; spawnRate = 1500;}
  if (diff === 'hard'){ speed = 3; spawnRate = 1000;}
  words = [];
  score = 0;
  missed = 0;
  scoreSpan.textContent = score;
  missedSpan.textContent = missed;
  gameOverDiv.style.display='none';
  typingInput.disabled = false;
  typingInput.value='';
  typingInput.focus();

  // تفريغ كلمات قديمة
  document.querySelectorAll('.word').forEach(el=>el.remove());

  // اختيار الكلمات حسب اللغة
  currentWordList = lang==='ar'?wordsAr:wordsEn;

  // بدء الإنترفال
  clearInterval(gameInterval);
  clearInterval(spawnInterval);
  gameInterval = setInterval(gameLoop,30);
  spawnInterval = setInterval(spawnWord,spawnRate);

  // إدخال المستخدم
  typingInput.oninput = checkInput;
}

function spawnWord(){
  const word = currentWordList[Math.floor(Math.random()*currentWordList.length)];
  const span = document.createElement('div');
  span.className='word';
  span.textContent=word;
  span.style.left = Math.random()*(gameArea.offsetWidth-100)+'px';
  span.style.top = '0px';
  gameArea.appendChild(span);
  words.push({el:span,word:word,y:0});
}

function gameLoop(){
  // تحريك الكلمات
  for (let i=0;i<words.length;i++){
    const w = words[i];
    w.y += speed;
    w.el.style.top = w.y+'px';
    // إذا وصلت أسفل
    if (w.y>gameArea.offsetHeight-40){
      missed++;
      missedSpan.textContent=missed;
      gameArea.removeChild(w.el);
      words.splice(i,1);
      i--;
      if (missed>=3){
        endGame();
      }
    }
  }
}

function checkInput(){
  const val = typingInput.value.trim();
  if (!val) return;
  // هل في كلمة مطابقة؟
  for (let i=0;i<words.length;i++){
    if (words[i].word===val){
      // إصابة
      score++;
      scoreSpan.textContent=score;
      // انفجار
      const ex = document.createElement('div');
      ex.className='explosion';
      ex.style.left=words[i].el.style.left;
      ex.style.top=words[i].el.style.top;
      gameArea.appendChild(ex);
      setTimeout(()=>ex.remove(),300);
      // حذف الكلمة
      gameArea.removeChild(words[i].el);
      words.splice(i,1);
      typingInput.value='';
      break;
    }
  }
}

function endGame(){
  clearInterval(gameInterval);
  clearInterval(spawnInterval);
  typingInput.disabled=true;
  finalScoreSpan.textContent=score;
  gameOverDiv.style.display='flex';
}
</script>

</body>
</html>
